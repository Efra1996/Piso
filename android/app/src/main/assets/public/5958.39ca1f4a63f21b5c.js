"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5958],{5958:(F,h,d)=>{d.r(h),d.d(h,{CuentasPageModule:()=>I});var f=d(6814),c=d(95),i=d(1024),b=d(6958),_=d(5861),e=d(6689),P=d(3590);let C=(()=>{var t;class s{constructor(){}}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),s})();function Z(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",24),e.NdJ("click",function(){e.CHM(n);const a=e.oxw(2);return e.KtG(a.setOpen(!0))}),e._uU(1,"SALDAR DEUDAS"),e.qZA()}}function v(t,s){1&t&&(e.TgZ(0,"ion-button",25),e._uU(1,"PA-GA-ME"),e.qZA())}function A(t,s){if(1&t&&(e.TgZ(0,"ion-card",16)(1,"ion-thumbnail",17),e._UZ(2,"img",18),e.qZA(),e.TgZ(3,"ion-card-header",19)(4,"ion-card-title",20),e._uU(5),e.ALo(6,"titlecase"),e.qZA(),e.TgZ(7,"ion-card-subtitle")(8,"ion-text"),e._uU(9),e.qZA()()(),e.TgZ(10,"ion-card-content")(11,"ion-item")(12,"ion-text",21),e._uU(13),e.ALo(14,"number"),e.qZA(),e.YNc(15,Z,2,0,"ion-button",22),e.YNc(16,v,2,0,"ion-button",23),e.qZA()()()),2&t){const n=s.$implicit;e.xp6(2),e.Q6J("src","mar\xeda"===n.nombre?"../../assets/icon/ariaF.jpeg":"../../assets/icon/efra.jpeg",e.LSH),e.xp6(3),e.Oqu(e.lcZ(6,10,n.nombre)),e.xp6(3),e.Udp("color",n.saldo>=0?"green":"red"),e.xp6(1),e.hij(" ",n.saldo>=0?"Saldo a favor:":"Saldo en contra:"," "),e.xp6(3),e.Udp("color",n.saldo>=0?"green":"red"),e.xp6(1),e.hij("",e.xi3(14,12,n.saldo,"1.2-2"),"\u20ac"),e.xp6(2),e.Q6J("ngIf",n.saldo<0),e.xp6(1),e.Q6J("ngIf",n.saldo>0)}}function T(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",30),e.NdJ("click",function(){e.CHM(n);const a=e.oxw(2);return e.KtG(a.saldarDeudaCompleta())}),e._uU(1,"SE HA PAGADO TODO!"),e.qZA()}}function M(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div")(1,"h1",31),e._uU(2,"\xbfCUANTO HAS PAGADO?"),e.qZA(),e._UZ(3,"ion-input",32),e.TgZ(4,"ion-input",33),e.NdJ("ionInput",function(a){e.CHM(n);const l=e.oxw(2);return e.KtG(l.comprobarCambios(a))}),e.qZA(),e.TgZ(5,"ion-button",34),e.NdJ("click",function(){e.CHM(n);const a=e.oxw(2);return e.KtG(a.saldarDeudaParte())}),e._uU(6," PAGAR "),e.qZA()()}if(2&t){const n=e.oxw(2);e.xp6(3),e.Q6J("value",n.cuentaDebe.saldo),e.xp6(2),e.Q6J("disabled",!(n.cantidadPagada>0&&n.cantidadPagada<=n.cuentaDebe.saldo))}}function O(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",26),e.YNc(1,T,2,0,"ion-button",27),e.TgZ(2,"ion-button",28),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.mostrarForm())}),e._uU(3,"SIGO SIENDO UN MOROSO!"),e.qZA(),e.YNc(4,M,7,2,"div",29),e.qZA()}if(2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",!n.moroso),e.xp6(3),e.Q6J("ngIf",n.moroso)}}function k(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",35)(1,"h1"),e._uU(2,"Nuevo Pago"),e.qZA(),e.TgZ(3,"form",36)(4,"ion-list",37)(5,"ion-item"),e._UZ(6,"ion-input",38),e.qZA(),e.TgZ(7,"ion-item"),e._UZ(8,"ion-input",39),e.qZA(),e.TgZ(9,"ion-item")(10,"ion-select",40)(11,"ion-select-option",41),e._uU(12,"Efra"),e.qZA(),e.TgZ(13,"ion-select-option",42),e._uU(14,"Mar\xeda"),e.qZA()()(),e.TgZ(15,"ion-item",19)(16,"ion-button",43),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.registrarNuevoPago())}),e._UZ(17,"ion-icon",44),e.qZA()()()()()}if(2&t){const n=e.oxw();e.xp6(3),e.Q6J("formGroup",n.formReg),e.xp6(13),e.Q6J("disabled",!n.formReg.valid)}}const D=function(){return[0,1]},J=[{path:"",component:(()=>{var t;class s{constructor(o,a,l,r){this.firebase=o,this.toastController=a,this.notificaciones=l,this.fb=r,this.cuentas=[],this.isModalOpen=!1,this.nuevoPago=!1,this.moroso=!1,this.cantidadPagada=0,this.formReg=this.fb.group({precio:new c.NI("",c.kI.required),nombre:new c.NI("",c.kI.required),pagador:new c.NI("",c.kI.required)}),this.getAll()}ngOnInit(){}setOpen(o){this.isModalOpen=o}setPago(o){this.nuevoPago=o}getAll(){var o=this;return(0,_.Z)(function*(){o.cuentas=[],yield o.firebase.recuperarSaldo().then(a=>{o.cuentas=a,o.cuentaDebe=o.cuentas.find(l=>l.saldo>0)}).catch()})()}solicitarPago(){}saldarDeudaCompleta(){this.cuentas.map(o=>{this.firebase.actualizarSaldo(o.nombre,0).then(()=>{this.mostrarToast("Estamos en paz!"),this.isModalOpen=!1,this.getAll()}).catch()})}saldarDeudaParte(){let o=[...this.cuentas],a=parseFloat(this.cantidadPagada.toString()),l=o.findIndex(u=>u.nombre===this.cuentaDebe.nombre),r=o.findIndex(u=>u.nombre!==this.cuentaDebe.nombre);o[l]={...o[l]},o[l].saldo-=this.cantidadPagada,o[r]={...o[r]},o[r].saldo=o[r].saldo+a,o.forEach(u=>{this.firebase.actualizarSaldo(u.nombre,u.saldo).then(()=>{this.cantidadPagada=0,this.isModalOpen=!1,this.moroso=!1,this.getAll(),this.mostrarToast("Se han actualizado los saldos!")}).catch()})}mostrarForm(){this.moroso=!0}pulsarFuera(o){this.isModalOpen=!1,this.moroso=!1,this.nuevoPago=!1}comprobarCambios(o){this.cantidadPagada=o.detail.value,console.log(o.detail.value)}registrarNuevoPago(){var o=this;return(0,_.Z)(function*(){let a=o.formReg.value.precio/2;const l=[{nombre:o.formReg.value.nombre,precio:o.formReg.value.precio,comprado:!1}];let r=[...o.cuentas],m=parseFloat(a.toString()),u=r.findIndex(p=>p.nombre!==o.formReg.value.pagador),g=r.findIndex(p=>p.nombre===o.formReg.value.pagador);r[u]={...r[u]},r[u].saldo-=a,r[g]={...r[g]},r[g].saldo=r[g].saldo+m,r.forEach(p=>{o.firebase.actualizarSaldo(p.nombre,p.saldo).then(()=>{o.cuentas=[],o.getAll()}).catch()}),yield o.firebase.historialCompra(o.formReg.value.pagador,l,o.formReg.value.precio,o.obtenerFechaYHoraActual()).then(()=>{o.cantidadPagada=0,o.nuevoPago=!1,o.formReg.controls.pagador.setValue(""),o.formReg.controls.nombre.setValue(""),o.formReg.controls.precio.setValue(""),o.mostrarToast("Se han actualizado los saldos!")}).catch()})()}mostrarToast(o){var a=this;return(0,_.Z)(function*(){yield(yield a.toastController.create({message:o,duration:2e3,position:"bottom",color:"success",buttons:[{side:"end",icon:"close-outline",role:"cancel",handler:()=>{console.log("Cerrar toast")}}]})).present()})()}doRefresh(o){this.moroso=!1,this.cuentas=[],this.formReg.controls.pagador.setValue(""),this.formReg.controls.nombre.setValue(""),this.formReg.controls.precio.setValue(""),this.getAll(),setTimeout(()=>{console.log("Recarga completada"),o.target.complete()},2e3)}obtenerFechaYHoraActual(){const o=new Date,a=o.getDate(),l=o.getMonth()+1,r=o.getFullYear(),m=o.getHours(),u=o.getMinutes();return`${a}/${l}/${r} ${m}:${u<10?"0"+u:u}`}}return(t=s).\u0275fac=function(o){return new(o||t)(e.Y36(P.O),e.Y36(i.yF),e.Y36(C),e.Y36(c.qu))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-cuentas"]],decls:22,vars:8,consts:[[3,"translucent"],[1,"ion-text-uppercase"],["slot","start"],["color","secondary"],[1,"center-title"],[1,"ion-padding",3,"fullscreen"],["collapse","condense"],["size","large"],["slot","fixed",3,"ionRefresh"],["style","border-radius: 25px; border: 1px solid rgb(255, 255, 255); ",4,"ngFor","ngForOf"],[3,"isOpen","initialBreakpoint","breakpoints","ionModalDidDismiss"],["slot","fixed","vertical","bottom","horizontal","end"],[3,"click"],["name","add"],["id","example-modal",3,"isOpen","ionModalDidDismiss"],["modal",""],[2,"border-radius","25px","border","1px solid rgb(255, 255, 255)"],[2,"margin-left","100px"],["alt","Foto de perfil",3,"src"],[1,"ion-align-items-center"],["color","light"],["slot","start",2,"font-size","20px"],["slot","end","fill","outline","shape","round","color","danger",3,"click",4,"ngIf"],["slot","end","fill","outline","shape","round","color","success",4,"ngIf"],["slot","end","fill","outline","shape","round","color","danger",3,"click"],["slot","end","fill","outline","shape","round","color","success"],[1,"block"],["expand","block","shape","round","color","success",3,"click",4,"ngIf"],["expand","block","shape","round","color","danger",3,"click"],[4,"ngIf"],["expand","block","shape","round","color","success",3,"click"],[2,"text-align","center","color","#ffffff"],["label","Debes en total:","readonly","true","color","light",2,"text-align","center","color","#ffffff",3,"value"],["label","A pagar : ","type","number","label-placement","floating","color","light",2,"text-align","center","color","#ffffff",3,"ionInput"],["expand","full","color","success",3,"disabled","click"],[1,"wrapper"],[3,"formGroup"],["lines","none"],["label","Concepto","formControlName","nombre"],["label","Precio","type","number","formControlName","precio"],["aria-label","Persona","interface","popover","placeholder","Elige al pringado que paga","formControlName","pagador"],["value","efra"],["value","mar\xeda"],["fill","clear","color","success",2,"margin-left","100px",3,"disabled","click"],["name","checkmark"]],template:function(o,a){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-menu-button",3),e.qZA(),e.TgZ(4,"ion-title",4),e._uU(5,"cuentas"),e.qZA()()(),e.TgZ(6,"ion-content",5)(7,"ion-header",6)(8,"ion-toolbar")(9,"ion-title",7),e._uU(10,"cuentas"),e.qZA()()(),e.TgZ(11,"ion-refresher",8),e.NdJ("ionRefresh",function(r){return a.doRefresh(r)}),e._UZ(12,"ion-refresher-content"),e.qZA(),e.YNc(13,A,17,15,"ion-card",9),e.TgZ(14,"ion-modal",10),e.NdJ("ionModalDidDismiss",function(r){return a.pulsarFuera(r)}),e.YNc(15,O,5,2,"ng-template"),e.qZA(),e.TgZ(16,"ion-fab",11)(17,"ion-fab-button",12),e.NdJ("click",function(){return a.setPago(!0)}),e._UZ(18,"ion-icon",13),e.qZA()(),e.TgZ(19,"ion-modal",14,15),e.NdJ("ionModalDidDismiss",function(r){return a.pulsarFuera(r)}),e.YNc(21,k,18,2,"ng-template"),e.qZA()()),2&o&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(7),e.Q6J("ngForOf",a.cuentas),e.xp6(1),e.Q6J("isOpen",a.isModalOpen)("initialBreakpoint",1)("breakpoints",e.DdM(7,D)),e.xp6(5),e.Q6J("isOpen",a.nuevoPago))},dependencies:[f.sg,f.O5,c._Y,c.JJ,c.JL,i.YG,i.Sm,i.PM,i.FN,i.Zi,i.tO,i.Dq,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.pK,i.Ie,i.q_,i.fG,i.nJ,i.Wo,i.t9,i.n0,i.yW,i.Bs,i.wd,i.sr,i.ki,i.as,i.QI,i.j9,c.sg,c.u,f.JJ,f.rS],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color: #1e1e1e}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color: #1e1e1e}ion-list[_ngcontent-%COMP%]{--ion-background-color: #f0f0f0}.center-title[_ngcontent-%COMP%]{text-align:center;width:100%;color:#f0f0f0;font-family:Roboto,sans-serif;font-weight:700;font-size:25px}ion-thumbnail[_ngcontent-%COMP%]{--size: 140px;--border-radius: 14px}ion-modal#example-modal[_ngcontent-%COMP%]{--width: fit-content;--min-width: 250px;--height: fit-content;--border-radius: 6px;--box-shadow: 0 28px 48px rgba(0, 0, 0, .4)}ion-modal#example-modal[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:20px 20px 10px}ion-modal#example-modal[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px;width:48px;height:48px;padding:4px 0;color:#aaa}ion-modal#example-modal[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{margin-bottom:10px}.block[_ngcontent-%COMP%]{width:100%;height:300px;background-color:#1e1e1e;padding:5px}ion-modal[_ngcontent-%COMP%]{--height: auto}ion-fab-button[_ngcontent-%COMP%]{--background: #b7f399;--background-activated: #87d361;--background-hover: #a3e681;--border-radius: 15px;--box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, .3), 0px 1px 3px 1px rgba(0, 0, 0, .15);--color: black}"]}),s})()}];let N=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[b.Bz.forChild(J),b.Bz]}),s})(),I=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.ez,c.u5,i.Pc,N,c.u5,c.UX]}),s})()}}]);